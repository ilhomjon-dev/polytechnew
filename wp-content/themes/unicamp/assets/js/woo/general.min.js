!function(_){"use strict";_.fn.serializeArrayAll=function(){var e=/\r?\n/g;return this.map(function(){return this.elements?jQuery.makeArray(this.elements):this}).map(function(a,i){var t=jQuery(this).val();return null==t||("checkbox"==this.type&&0==this.checked?{name:this.name,value:this.checked?this.value:""}:jQuery.isArray(t)?jQuery.map(t,function(a,t){return{name:i.name,value:a.replace(e,"\r\n")}}):{name:i.name,value:t.replace(e,"\r\n")})}).get()};var n=_("body");function r(a,t){t.removeClass("loading"),_.magnificPopup.open({mainClass:"mfp-fade popup-product-quick-view",items:{src:a.html(),type:"inline"},callbacks:{open:function(){var a=this.content.find(".product-container"),t=window.innerHeight-60,t=Math.min(t,760),t=(a.outerHeight(t),a.perfectScrollbar({suppressScrollX:!0}),this.content.find(".woo-single-gallery")),a=t.children(".unicamp-thumbs-swiper").UnicampSwiper(),p=t.children(".unicamp-main-swiper").UnicampSwiper({thumbs:{swiper:a}}),m=("undefined"!=typeof isw&&void 0!==isw.Swatches&&isw.Swatches.init(),"undefined"!=typeof wc_add_to_cart_variation_params&&this.content.find(".variations_form").each(function(){_(this).wc_variation_form()}),this.content.find(".variations_form")),f=m.data("product_variations");m.find("select").on("change",function(){for(var a=!0,t=!1,i={},e=m.serializeArray(),n=0;n<e.length;n++){var r=e[n].name;if("attribute_"===r.substring(0,10)&&(i[r]=e[n].value,""===e[n].value)){a=!1;break}}if(!0===a){for(var d=Object.entries(i),o=0,c=0,n=f.length-1;0<=n;n--){var s=f[n],u=Object.entries(s.attributes),l=0;u.forEach(([i,e])=>{d.forEach(([a,t])=>{a!==i||t!==e&&""!==e||l++})}),c<l&&(c=l,o=s.image_id)}o?p.$wrapperEl.find(".swiper-slide").each(function(a){var t=_(this).attr("data-image-id");if(parseInt(t)===o)return p.slideTo(a),!1}):t=!0}else t=!0;t&&(t=p.$wrapperEl.find(".product-main-image").index(),p.slideTo(t))})}}})}_(document).ready(function(){var e;_(".unicamp-product").on("click",".quick-view-btn",function(a){a.preventDefault(),a.stopPropagation();var t=_(this),a=(t.parents(".product-actions").first().addClass("refresh"),t.addClass("loading"),t.data("pid")),i=n.children("#popup-product-quick-view-content-"+a);0<i.length?r(i,t):_.ajax({url:$unicamp.ajaxurl,type:"POST",data:_.param({action:"product_quick_view",pid:a}),dataType:"json",success:function(a){i=_(a.template),n.append(i),r(i,t)}})}),e=[],n.on("click",".ajax_add_to_cart",function(){var a=_(this).parents(".cart-notification").first().data("notification"),t='<span class="added-text">'+$unicamp.noticeAddedCartText+"</span>",i=t;void 0!==a&&(i='<div class="product-added-cart">',""!==a.image&&(i+='<div class="product-thumbnail"><img src="'+a.image+'" alt="'+a.title+'"/></div>'),i=i+('<div class="product-caption"><h3 class="product-title">'+a.title)+" </h3>"+t+"</div></div>"),i+='<div class="tm-button-wrapper btn-view-cart"><a href="'+$unicamp.noticeCartUrl+'" class="tm-button button-grey style-flat tm-button-xs tm-button-full-wide">'+$unicamp.noticeCartText+"</a></div>",e.push(i)}),n.on("added_to_cart",function(){for(var a=0;a<e.length;a++)_.growl({location:"br",duration:5e3,title:"",message:e[a]}),e.splice(a,1)}),"undefined"!=typeof wc_add_to_cart_params&&_(document).on("click","button.single_add_to_cart_button.ajax_add_to_cart",function(a){a.preventDefault();var t,i,e,n,r=_(this);return!r.hasClass("disabled")&&!r.hasClass("woosb-disabled")&&(t=(a=r.closest("form.cart")).find("[name=add-to-cart]").val(),i=a.find("input[name=variation_id]").val(),e=a.find(".quantity .qty[name=quantity]").val(),void(0!==(t="add-to-cart"===r.attr("name")?r.val():t)&&(n={product_id:t,variation_id:i},a.serializeArray().map(function(a){var t;"add-to-cart"!==a.name&&(a.name.endsWith("[]")?((t=a.name.substring(0,a.name.length-2))in n||(n[t]=[]),n[t].push(a.value)):n[a.name]=a.value)}),r.attr("data-qty")&&(e=parseInt(r.attr("data-qty"))),n.quantity=e,r.removeClass("added").addClass("loading updating-icon"),_("body").trigger("adding_to_cart",[r,n]),_.post(wc_add_to_cart_params.wc_ajax_url.toString().replace("%%endpoint%%","unicamp_add_to_cart"),n,function(a){var t;a&&(a.error&&a.product_url?window.location=a.product_url:(t=r.data("redirect"))&&""!==t?window.location=t:"yes"===wc_add_to_cart_params.cart_redirect_after_add?window.location=wc_add_to_cart_params.cart_url:_(document.body).trigger("added_to_cart",[a.fragments,a.cart_hash,r]))}).always(function(){r.addClass("added").removeClass("loading updating-icon")}))))})})}(jQuery);